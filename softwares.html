<!DOCTYPE html>
<html lang="en_US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta name="author" content="Jerry Chaos" />
    <meta name="applicable-device" content="pc,pad,mobile" />
    <meta name="referrer" content="always" />
    <title>Jerry Chaos</title>
    <link href="./favicon.ico" rel="shortcut icon">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="tabs size-full">
        <input type="radio" name="mytabs" id="tab1" onchange="refreshOutput()" checked>
        <label for="tab1">SOFTWARE</label>
        <div class="tabs-content">
            <div id="mainDiv" class="list-container"> </div>
            <div class="textarea-outer">
                <div class="textarea-head">
                    <div class="textarea-caption">
                        <!-- commands of powershell -->
                    </div>
                    <div class="textarea-buttons">
                        <div role="button" onclick="switchSilent(this)" marked>
                            <span>SILENT ON</span>
                        </div>
                        <div role="button" onclick="clearAll()">
                            <span>CLEAR</span>
                        </div>
                        <div role="button" onclick="copyToClipboard()">
                            <span>COPY</span>
                        </div>
                    </div>
                </div>
                <textarea class="textarea" spellcheck="false" id="outputElem" oninput="autoResize(this)"
                    placeholder="select software above ..."></textarea>
            </div>
            <div>
                <ul>
                    <li OhMyPosh><b>OhMyPosh</b> is a plugin of PowerShell, install PS first. </li>
                    <li Neovim><b>Neovim</b> plugin repository (private):
                        <a href="https://github.com/zspark/nvim" target="_blank">nvim<svg class="icon size-16">
                                <use href="./icons.svg#icon-external-link-1"
                                    xlink:href="./icons.svg#icon-external-link-1">
                                </use>
                            </svg>
                        </a>After downloading, place it in: <code>$HOME\AppData\Local\(<b>nvim</b>)</code>
                    </li>
                    <li Neovim><b>Neovim</b> plugin system requires downloading and compiling C++ code. Please
                        install
                        cpp
                        compiler
                        first:
                        <a target="_blank" href="https://jmeubank.github.io/tdm-gcc/">TDM-gcc<svg class="icon size-16">
                                <use href="./icons.svg#icon-external-link-1"
                                    xlink:href="./icons.svg#icon-external-link-1">
                                </use>
                            </svg>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <input type="radio" name="mytabs" id="tab2" onchange="refreshOutput()">
        <label for="tab2">SYSTEM</label>
        <div class="tabs-content">
            <div id="system">
                <ul>
                    <li>During system installation, press <code>Shift+F10</code> when connecting to Wi-Fi, enter
                        <code>oobe\bypassnro</code>, and then restart.
                    </li>
                    <li>This will display the <code>"I don't have an internet connection"</code> option.</li>
                    <li>Enter the product key: The following are generic Windows product keys:</li>
                    <ul>
                        <li>Professional: VK7JG-NPHTM-C97JM-9MPGT-3V66T</li>
                        <li>Home: YTMG3-N6DKC-DKB77-7M9GH-8HVX7</li>
                        <li>Enterprise: XGVPP-NMH47-7TTHJ-W3FW7-8HV2C</li>
                        <li>Education: YNMGQ-8RYV3-4PGQ3-C8XTP-7CFBY</li>
                    </ul>
                </ul>
            </div>
        </div>

    </div>
</body>

<script>
    console.log("Hello Jerry!");

    const _data = {
        "WindowsTerminal": { caption: "WindowsTerminal", wingetId: "Microsoft.WindowsTerminal" },
        "PowerShell": { caption: "PowerShell", wingetId: "Microsoft.PowerShell", large: true, checked: true },
        "fd": { caption: "fd", wingetId: "sharkdp.fd", large: true, checked: true },
        "ripgrep": { caption: "ripgrep", wingetId: "BurntSushi.ripgrep.MSVC", large: true, checked: true },
        "7zip": { caption: "7zip", wingetId: "7zip.7zip" },
        "Git": { caption: "Git", wingetId: "Git.Git", large: true },
        "Nodejs": { caption: "Node.js", wingetId: "OpenJS.NodeJS", large: true, },
        "StrawberryPerl": { caption: "StrawberryPerl", wingetId: "StrawberryPerl.StrawberryPerl" },
        "Python": { caption: "Python", wingetId: "Python.Python.3.14" },
        "ShareX": { caption: "ShareX", wingetId: "ShareX.ShareX" },
        "Ninja": { caption: "Ninja", wingetId: "Ninja-build.Ninja" },
        "CMake": { caption: "CMake", wingetId: "Kitware.CMake" },
        "LazyGit": { caption: "LazyGit", wingetId: "JesseDuffield.lazygit" },
        "OBS_Studio": { caption: "OBS Studio", wingetId: "OBSProject.OBSStudio", large: true, },
        "Everything": { caption: "Everything", wingetId: "voidtools.Everything" },
        "SumatraPDF": { caption: "SumatraPDF", wingetId: "SumatraPDF.SumatraPDF", large: true, checked: true },
        "PDFgear": { caption: "PDFgear", wingetId: "PDFgear.PDFgear" },
        "OhMyPosh": { caption: "OhMyPosh", wingetId: "JanDeDobbeleer.OhMyPosh" },
        "NotepadPlusPlus": { caption: "Notepad++", wingetId: "Notepad++.Notepad++" },
        "VLC": { caption: "VLC", wingetId: "VideoLAN.VLC", large: true, checked: true },
        "GitHubDesktop": { caption: "GitHub Desktop", wingetId: "GitHub.GitHubDesktop", large: true },
        "VSCode": { caption: "VSCode", wingetId: "Microsoft.VisualStudioCode" },
        "Neovim": { caption: "Neovim", wingetId: "Neovim.Neovim" },
        "MiKTeX": { caption: "MiKTeX", wingetId: "MiKTeX.MiKTeX", large: true, checked: true },
        "TeXstudio": { caption: "TeXstudio", wingetId: "TeXstudio.TeXstudio", large: true, checked: true },
        "PowerToys": { caption: "PowerToys", wingetId: "Microsoft.PowerToys" },
        "foobar2000": { caption: "foobar2000", wingetId: "PeterPawlowski.foobar2000" },
        "soundly": { caption: "soundly", wingetId: "Soundly.Soundly" },
    };

    let silentMode = true;
    const outputElem = document.getElementById("outputElem");

    function _createCB(id, data) {
        const isLarge = data.large ?? false;
        return `<label id="${id}" class="checkboxWithLabel">
    <input type="checkbox" class="size-18" name="${id}" ${data.checked ? 'checked' : ''}/>
    <div class="${isLarge ? 'text-large' : 'text-normal'}"> ${data.caption} </div>
</label>`;
    }

    function refreshOutput() {
        let wingetCommands = [];
        const checkboxes = mainDiv.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((checkbox) => {
            if (checkbox.checked) {
                const appData = _data[checkbox.name];
                if (appData && appData.wingetId) {
                    let _cmd = `winget install --id ${appData.wingetId} --source winget -e`;
                    if (silentMode)
                        _cmd += ` --silent --accept-source-agreements --accept-package-agreements`;
                    wingetCommands.push(_cmd);
                }
            }
        });
        outputElem.value = wingetCommands.length > 0 ? wingetCommands.join('\n') + '\n' : "";
        autoResize(outputElem);
    }

    function copyToClipboard() {
        outputElem.select();
        outputElem.setSelectionRange(0, 99999); // For mobile devices
        document.execCommand("copy");
    }

    function autoResize(elem) {
        const _parentElem = elem.parentElement;
        _parentElem.style.height = "auto";
        elem.style.height = "auto";

        const _height = elem.scrollHeight;
        _parentElem.style.height = _height + 18 + 'px';
        elem.style.height = _height + 'px';
    }

    function switchSilent(btnElem) {
        silentMode = !btnElem.hasAttribute("marked");
        if (silentMode) {
            btnElem.setAttribute("marked", "");
            btnElem.innerHTML = "<span>SILENT ON</span>";
        } else {
            btnElem.removeAttribute('marked');
            btnElem.innerHTML = "<span>SILENT OFF</span>";
        }
        refreshOutput();
    }

    function clearAll(a) {
        const checkboxes = mainDiv.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((checkbox) => {
            checkbox.checked = false;
        });
        refreshOutput();
    }

    window.onload = () => {
        let _renderContent = '';
        for (const [key, value] of Object.entries(_data)) {
            _renderContent += _createCB(key, value);
        }

        const mainDiv = document.getElementById("mainDiv");
        mainDiv.innerHTML = _renderContent;
        mainDiv.addEventListener('change', (event) => {
            const target = event.target;
            if (target.name in _data) {
                refreshOutput();
            }
        });

        for (const [key, _] of Object.entries(_data)) {
            const _elem = document.getElementById(key);
            _elem.addEventListener('mouseenter', (e) => {
                const _id = e.target.id;
                const _tipElems = document.querySelectorAll(`li[${_id}]`) ?? [];
                _tipElems.forEach((ele) => {
                    ele.classList.add('color-red')
                })
            });
            _elem.addEventListener('mouseleave', (e) => {
                const _id = e.target.id;
                const _tipElems = document.querySelectorAll(`li[${_id}]`) ?? [];
                _tipElems.forEach((ele) => {
                    ele.classList.remove('color-red')
                })
            });
        }

        refreshOutput();
    };

    window.onresize = () => {
        refreshOutput();
    }
</script>

</html>